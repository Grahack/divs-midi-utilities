
Current plans for the sequencer project ("Seqer") as of 2019-11-21:

This generation of Seqer is fairly conventional, a single window focused on a piano roll.

The piano roll consists of a configurable list of horizontal lanes, all of which are tied to the same linear time ruler (configurable for linearity in musical time versus wall-clock time but displaying both).  There are different types of lanes for notes, numeric values, and labels.  Note lanes are obvious; numeric value lanes are used for velocity, controllers, pitch bend, aftertouch, and tempo; but label lanes require a bit more description.  They're used for lyrics, markers, text events, time signatures, key signatures, and the event type names of any events in the file (this last case takes the place of a traditional event list view).  They consist of short strings in boxes whose left edges want to align with a particular time on the time ruler, but are shoved out of a single horizontal row if they would overlap other label boxes.  If you run out of rows in the lane and still need to shove more labels into a time, then multiple boxes are placed side by side in a single row, wrapping to fit everything in the available number of rows and the least amount of horizontal space.  Events at times anywhere in that horizontal space are rendered as if they all occurred at the earliest time of that space.  Order of events in this type of lane strictly follows the order they occur in the file (spacially corresponding to English reading order).

There is a side panel with different tabs.  The event tab allows you to see and edit all the properties of the currently selected event(s), which removes the need to expose all properties directly in the lanes.  The tracks tab shows the list of tracks in the file, with controls for mute, solo, arm, show/hide, which track to use for new events, rename, add, remove, and reorder.  The channels tab shows the standard list of 16 channels with controls for show/hide and which channel to use for new events; the same channel choices are used for all tracks.  The lanes tab shows the list of lanes and controls for their properties including lane type and whether it should use its own versus global track and channel settings; it also has controls for add, remove, and reorder.

There is an editing caret in the current lane, where new events will be inserted.  You can use the keyboard to navigate it in the cardinal directions (by pixel, by quantization granularity, by octave, to the next/previous marker, etc) or to the nearest displayed event in that direction, whichever is closer.  You can also move the caret by clicking with the mouse.  If you navigate to an event via either input device, the selection is replaced with that event.  If you hold shift while doing so, that event is added to the selection.  You can also drag-select with the mouse if you start in an empty space.  Dragging an event moves it; events in note lanes differentiate between the horizontal effects of dragging on the middle of the box (start and end time), left edge (start time), and right edge (end time).  There are also keyboard controls for incrementing or decrementing (by pixel, by quantization granularity, by octave, etc) properties of the currently selected event.

There are keyboard and mouse controls for zooming and scrolling the current lane vertically, and for zooming and scrolling the time axis horizontally (shared by all lanes).  There are no widgets for these operations except possibly a scrollbar for the time axis; instead they rely on the scrollwheel, gestures, or drag modes.

The playback caret is not the same as the editing caret but can be set from it.  There's an operation to insert time (for all tracks) at the editing caret.  There's also an operation to start selecting a time range (with subsequent navigation) rather than a set of events, which can be used for deleting, copying, and pasting across all events in all tracks whether or not they are visible.

The editing caret, playback caret, selected events, and selected time range are all stored as data inside the MIDI file not ephemerally in the view.  This allows the undo stack to be a simple list of file snapshots, as well as supporting external helper utilities.




Lanes showing track or channel -specific values other than note lanes should inherit visibility and insertion settings from the nearest preceding note lane.  This will eliminate the need for view-specific vs. global track and channel settings and solve the problem of how to associate key pressure with a particular note. 


